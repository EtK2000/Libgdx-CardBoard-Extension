ext {
     gdxVersion='1.5.4'
}

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:1.2.3'
        classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:1.4'
    }
}

allprojects {
    repositories {
        jcenter()
    }
}

project(":libgdx-cardboard-core") {
	apply plugin: "java"
	apply plugin: 'com.jfrog.bintray'
	group = 'com.yangwei'
	version = '0.2'

	dependencies {
	    compile "com.badlogicgames.gdx:gdx-backend-android:${gdxVersion}"
	    compile "com.badlogicgames.gdx:gdx:${gdxVersion}"
	    compile fileTree(dir: 'libs', include: ['*.jar'])
	    compile 'com.google.protobuf:protobuf-java:2.6.1'
	}

	sourceSets {
	    main {
	        java {
	            srcDir 'src'
	        }
	        resources {
	            srcDir 'src'
	        }
	    }
	}

	task copyPom(type: Copy) {
	    from 'pom.xml'
	    into "$buildDir/libs"
	    rename 'pom.xml', "${project.name}-${version}.pom"
	}

	task sourcesJar(type: Jar, dependsOn: [classes, "copyPom"]) {
	    classifier = 'sources'
	    from sourceSets.main.allSource
	}

	task javadocJar(type: Jar, dependsOn: javadoc) {
	    classifier = 'javadoc'
	    from javadoc.destinationDir
	}

	artifacts {
	    archives sourcesJar
	    archives javadocJar
	    archives file("$buildDir/libs/${project.name}-${version}.pom")
	}

	sourceCompatibility = 1.7
	targetCompatibility = 1.7

	bintray {
	    user = System.getenv('BINTRAY_USER')
	    key = System.getenv('BINTRAY_KEY')
	    configurations = ['archives']
		pkg {
			repo = 'maven'
			name = 'com.yangwei:libgdx-cardboard-core'
			licenses = ['Apache-2.0']
			vcsUrl = 'https://github.com/yangweigbh/Libgdx-CardBoard-Extension.git'
			version {
				name = '0.2'
				desc = 'libgdx cardboard extension 0.2'
				vcsTag = '0.2.0'
			}
		}
	}
}

project(":Demo") {
	apply plugin: 'com.android.application'

	android {
	    compileSdkVersion 23
	    buildToolsVersion "23.0.1"

	    defaultConfig {
	        minSdkVersion 9
	        targetSdkVersion 23
	        versionCode 1
	        versionName "1.0"
	    }

	    sourceSets {
	        main {
	            manifest.srcFile 'AndroidManifest.xml'
	            java.srcDirs = ['src']
	            resources.srcDirs = ['src']
	            aidl.srcDirs = ['src']
	            renderscript.srcDirs = ['src']
	            res.srcDirs = ['res']
	            assets.srcDirs = ['assets']
	        }

	        androidTest.setRoot('tests')
	    }
	}

	dependencies {
	    compile "com.badlogicgames.gdx:gdx-backend-android:${gdxVersion}"
	    compile "com.badlogicgames.gdx:gdx:${gdxVersion}"
	    compile fileTree(dir: 'libs', include: ['*.jar'])
	    compile 'com.google.protobuf:protobuf-java:2.6.1'
	    compile project(":libgdx-cardboard-core")
	}

	tasks.withType(com.android.build.gradle.tasks.PackageApplication) { pkgTask ->
        pkgTask.jniFolders = new HashSet<File>()
        pkgTask.jniFolders.add(new File(projectDir, 'libs'))
    }
}